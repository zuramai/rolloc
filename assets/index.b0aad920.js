var x=Object.defineProperty;var w=(e,t,r)=>t in e?x(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var u=(e,t,r)=>(w(e,typeof t!="symbol"?t+"":t,r),r);const b=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}};b();var v=Object.defineProperty,m=Object.getOwnPropertySymbols,P=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable,p=(e,t,r)=>t in e?v(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,h=(e,t)=>{for(var r in t||(t={}))P.call(t,r)&&p(e,r,t[r]);if(m)for(var r of m(t))A.call(t,r)&&p(e,r,t[r]);return e},C=(e,t,r)=>(p(e,typeof t!="symbol"?t+"":t,r),r),S={size:500,padding:0,arrow:{startPointAtDeg:100,gapFromCenter:10,lineLength:70},rollOptions:{duration:5e3},items:[]},f=class{constructor(e,t){u(this,"el");u(this,"elements",{});u(this,"options");u(this,"degreeRotated",0);this.options=h(h({},S),t),this.mount(e)}resolveSelector(e){return typeof e=="string"?document.querySelector(e):e||null}getRadius(){return this.options.size/2-this.options.padding*2}mount(e){if(this.el)throw new Error("[rolloc] already mounted, unmount previous target first");let t=this.resolveSelector(e);if(!t)throw new Error("[rolloc] target element not found");this.el=document.createElementNS(f.ns,"svg"),this.el.setAttributeNS(null,"viewBox",`0 0 ${this.options.size} ${this.options.size}`),this.el.setAttributeNS(null,"width",this.options.size.toString()),this.el.setAttributeNS(null,"height",this.options.size.toString()),this.draw(),t.appendChild(this.el)}draw(){let e=this.getRadius(),{x:t,y:r}=this.getCenterPoint(),n=a("circle",{class:"rolloc__outer-circle",cx:t.toString(),cy:r.toString(),r:e.toString(),fill:"white"}),i=a("circle",{class:"rolloc__inner-circle",cx:t,cy:r,r:20,fill:"#ccc",stroke:"#333"}),o=this.options.arrow,s=this.getCenterPoint(),c=this.getArcCoordinate(o.startPointAtDeg,o.lineLength),l=a("line",{class:"rolloc__arrow",x1:s.x,x2:c.x,y1:s.y,y2:c.y,stroke:"black"});this.appendEl("outerCircle",n),this.appendEl("line",l),this.appendEl("itemsGroup",this.drawItems()),this.appendEl("innerCircle",i);let d={x:o.startPointAtDeg>270||o.startPointAtDeg<=90?0:100,y:o.startPointAtDeg<180?0:100};l.setAttribute("style",`transform-origin: ${d.x}% ${d.y}%; 
                                    transform-box: fill-box;
                                    `)}drawItems(){let e=a("g",{class:"rolloc__item-group"}),t=this.options.items,r=t.length,n=this.getRadius();for(let i=0;i<r;i++){let o=a("g",{class:"rolloc__item"}),s=t[i],c=1/r*360,l={start:i*c,end:(i+1)*c};s.startAngle=l.start,s.endAngle=l.end;let d=this.drawPie(l.start,l.end,n),y=this.drawText(s.text,l.start,l.end,n);o.appendChild(y),o.appendChild(d),e.appendChild(o)}return e}drawPie(e,t,r){let n=[this.getArcCoordinate(e,r),this.getArcCoordinate(t,r)],i=this.getPiePath(n[0],n[1]);return a("path",{d:i,class:"rolloc__pie",stroke:"black",fill:"transparent"})}drawText(e,t,r,n){let i=this.getArcCoordinate(t+(r-t)/2,n*2/3);return a("text",{x:i.x,y:i.y,"text-anchor":"middle","transform-box":"fill-box","transform-origin":"center","dominant-baseline":"middle"},e)}appendEl(e,t){this.el.appendChild(t),this.elements[e]=t}getPiePath(e,t){let{x:r,y:n}=this.getCenterPoint(),i=1/this.options.items.length*360<=180?0:1,o=this.getRadius();return`
            M${r},${n}
            L${e.x},${e.y}
            A${o},${o} 0 ${i} 1 ${t.x} ${t.y}
            L${r},${n}
            Z
        `}getCenterPoint(){return{x:this.options.size/2,y:this.options.size/2}}getArcCoordinate(e,t){t||(t=this.getRadius());let r=this.getCenterPoint(),n=e*Math.PI/180,i=t*Math.cos(n),o=t*Math.sin(n);return{x:i+r.x,y:o+r.y}}roll(e){e=h(h({},this.options.rollOptions),e);let t=this.elements.line,r=typeof e.duration=="object"?Math.floor(Math.random()*(e.duration.max-e.duration.min+1)+e.duration.min):~~e.duration,n=r*(Math.random()*2+1);return this.degreeRotated+=n,t.animate([{rotate:this.degreeRotated+"deg"}],{duration:r,fill:"forwards",easing:"cubic-bezier(0.16, 1, 0.3, 1)"}),new Promise(i=>setTimeout(()=>i(this.getResult()),r))}getResult(){let e=(this.degreeRotated+this.options.arrow.startPointAtDeg)%360;for(let t=0;t<this.options.items.length;t++){let r=this.options.items[t];if(e>r.startAngle&&e<=r.endAngle)return r}return null}},g=f;C(g,"ns","http://www.w3.org/2000/svg");function a(e,t,r=""){let n=document.createElementNS(g.ns,e);return Object.keys(t).forEach(i=>n.setAttribute(i,t[i].toString())),n.innerHTML=r,n}function $(e,t){return new g(e,t)}const E=$("#roller",{items:[{value:"grape",text:"Grape"},{value:"apple",text:"Apple"},{value:"orange",text:"Orange"},{value:"lemon",text:"Lemon"}],arrow:{startPointAtDeg:220,gapFromCenter:10,lineLength:70}});let O=document.querySelector("button");O.addEventListener("click",e=>{e.preventDefault();let t=document.querySelector("input");E.roll({duration:~~t.value}).then(r=>{alert("success roll, result = "+r.value)})});
