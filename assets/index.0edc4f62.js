var x=Object.defineProperty;var b=(t,e,r)=>e in t?x(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var u=(t,e,r)=>(b(t,typeof e!="symbol"?e+"":e,r),r);const w=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}};w();var v=Object.defineProperty,m=Object.getOwnPropertySymbols,A=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable,p=(t,e,r)=>e in t?v(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,h=(t,e)=>{for(var r in e||(e={}))A.call(e,r)&&p(t,r,e[r]);if(m)for(var r of m(e))C.call(e,r)&&p(t,r,e[r]);return t},S=(t,e,r)=>(p(t,typeof e!="symbol"?e+"":e,r),r),P={size:500,padding:0,anchor:{type:"line",positionAngle:100,gapFromCenter:10,length:70},rollOptions:{type:"circle",duration:5e3},items:[]},f=class{constructor(t,e){u(this,"el");u(this,"elements",{});u(this,"options");u(this,"degreeRotated",0);this.options=h(h({},P),e),this.mount(t)}resolveSelector(t){return typeof t=="string"?document.querySelector(t):t||null}getRadius(){return this.options.size/2-this.options.padding*2}mount(t){if(this.el)throw new Error("[rolloc] already mounted, unmount previous target first");let e=this.resolveSelector(t);if(!e)throw new Error("[rolloc] target element not found");this.el=document.createElementNS(f.ns,"svg"),this.el.setAttributeNS(null,"viewBox",`0 0 ${this.options.size} ${this.options.size}`),this.el.setAttributeNS(null,"width",this.options.size.toString()),this.el.setAttributeNS(null,"height",this.options.size.toString()),this.draw(),e.appendChild(this.el)}draw(){let t=this.getRadius(),{x:e,y:r}=this.getCenterPoint(),n=a("circle",{class:"rolloc__outer-circle",cx:e.toString(),cy:r.toString(),r:t.toString(),fill:"white"}),o=a("circle",{class:"rolloc__inner-circle",cx:e,cy:r,r:20,fill:"#ccc",stroke:"#333"}),i=this.options.anchor,s;if(i.type=="line"){let l=this.getCenterPoint(),d=this.getArcCoordinate(i.positionAngle,i.length);s=a("line",{class:"rolloc__arrow",x1:l.x,x2:d.x,y1:l.y,y2:d.y,stroke:"black"})}this.appendEl("outerCircle",n),this.appendEl("anchor",s),this.appendEl("itemsGroup",this.drawItems()),this.appendEl("innerCircle",o);let c={x:i.positionAngle>270||i.positionAngle<=90?0:100,y:i.positionAngle<180?0:100};s.setAttribute("style",`transform-origin: ${c.x}% ${c.y}%; 
                                    transform-box: fill-box;
                                    `)}drawItems(){let t=a("g",{class:"rolloc__item-group"}),e=this.options.items,r=e.length,n=this.getRadius();for(let o=0;o<r;o++){let i=a("g",{class:"rolloc__item"}),s=e[o],c=1/r*360,l={start:o*c,end:(o+1)*c};s.startAngle=l.start,s.endAngle=l.end;let d=this.drawPie(l.start,l.end,n),y=this.drawText(s.text,l.start,l.end,n);i.appendChild(y),i.appendChild(d),t.appendChild(i)}return t}drawPie(t,e,r){let n=[this.getArcCoordinate(t,r),this.getArcCoordinate(e,r)],o=this.getPiePath(n[0],n[1]);return a("path",{d:o,class:"rolloc__pie",stroke:"black",fill:"transparent"})}drawText(t,e,r,n){let o=this.getArcCoordinate(e+(r-e)/2,n*2/3);return a("text",{x:o.x,y:o.y,"text-anchor":"middle","transform-box":"fill-box","transform-origin":"center","dominant-baseline":"middle"},t)}appendEl(t,e){this.el.appendChild(e),this.elements[t]=e}getPiePath(t,e){let{x:r,y:n}=this.getCenterPoint(),o=1/this.options.items.length*360<=180?0:1,i=this.getRadius();return`
            M${r},${n}
            L${t.x},${t.y}
            A${i},${i} 0 ${o} 1 ${e.x} ${e.y}
            L${r},${n}
            Z
        `}getCenterPoint(){return{x:this.options.size/2,y:this.options.size/2}}getArcCoordinate(t,e){e||(e=this.getRadius());let r=this.getCenterPoint(),n=t*Math.PI/180,o=e*Math.cos(n),i=e*Math.sin(n);return{x:o+r.x,y:i+r.y}}roll(t){t=h(h({},this.options.rollOptions),t);let e=this.elements.anchor,r=typeof t.duration=="object"?Math.floor(Math.random()*(t.duration.max-t.duration.min+1)+t.duration.min):~~t.duration,n=r*(Math.random()*2+1);return this.degreeRotated+=n,e.animate([{rotate:this.degreeRotated+"deg"}],{duration:r,fill:"forwards",easing:"cubic-bezier(0.16, 1, 0.3, 1)"}),new Promise(o=>setTimeout(()=>o(this.getResult()),r))}getResult(){let t=(this.degreeRotated+this.options.anchor.positionAngle)%360;for(let e=0;e<this.options.items.length;e++){let r=this.options.items[e];if(t>r.startAngle&&t<=r.endAngle)return r}return null}},g=f;S(g,"ns","http://www.w3.org/2000/svg");function a(t,e,r=""){let n=document.createElementNS(g.ns,t);return Object.keys(e).forEach(o=>n.setAttribute(o,e[o].toString())),n.innerHTML=r,n}function $(t,e){return new g(t,e)}const E=$("#roller",{items:[{value:"grape",text:"Grape"},{value:"apple",text:"Apple"},{value:"orange",text:"Orange"},{value:"lemon",text:"Lemon"}],anchor:{type:"line",positionAngle:220,gapFromCenter:10,length:70}});let O=document.querySelector("button");O.addEventListener("click",t=>{t.preventDefault();let e=document.querySelector("input");E.roll({duration:~~e.value}).then(r=>{alert("success roll, result = "+r.value)})});
