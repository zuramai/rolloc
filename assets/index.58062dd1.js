var x=Object.defineProperty;var b=(e,t,r)=>t in e?x(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var c=(e,t,r)=>(b(e,typeof t!="symbol"?t+"":t,r),r);const w=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}};w();var v=Object.defineProperty,f=Object.getOwnPropertySymbols,P=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable,p=(e,t,r)=>t in e?v(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,h=(e,t)=>{for(var r in t||(t={}))P.call(t,r)&&p(e,r,t[r]);if(f)for(var r of f(t))A.call(t,r)&&p(e,r,t[r]);return e},C=(e,t,r)=>(p(e,typeof t!="symbol"?t+"":t,r),r),S={size:500,padding:0,arrow:{startPointAtDeg:100,gapFromCenter:10,lineLength:70},rollOptions:{duration:5e3},items:[]},y=class{constructor(e,t){c(this,"el");c(this,"elements",{});c(this,"options");c(this,"degreeRotated",0);this.options=h(h({},S),t),this.mount(e)}resolveSelector(e){return typeof e=="string"?document.querySelector(e):e||null}getRadius(){return this.options.size/2-this.options.padding*2}mount(e){if(this.el)throw new Error("[rolloc] already mounted, unmount previous target first");let t=this.resolveSelector(e);if(!t)throw new Error("[rolloc] target element not found");this.el=document.createElementNS(y.ns,"svg"),this.el.setAttributeNS(null,"viewBox",`0 0 ${this.options.size} ${this.options.size}`),this.el.setAttributeNS(null,"width",this.options.size.toString()),this.el.setAttributeNS(null,"height",this.options.size.toString()),this.draw(),t.appendChild(this.el)}draw(){let e=this.getRadius(),{x:t,y:r}=this.getCenterPoint(),n=l("circle",{class:"rolloc__outer-circle",cx:t.toString(),cy:r.toString(),r:e.toString(),fill:"white"}),o=l("circle",{class:"rolloc__inner-circle",cx:t,cy:r,r:20,fill:"#ccc",stroke:"#333"}),i=this.options.arrow,s=this.getCenterPoint(),a=this.getArcCoordinate(i.startPointAtDeg,i.lineLength),d=l("line",{class:"rolloc__arrow",x1:s.x,x2:a.x,y1:s.y,y2:a.y,stroke:"black"});this.appendEl("outerCircle",n),this.appendEl("line",d),this.appendEl("itemsGroup",this.drawItems()),this.appendEl("innerCircle",o),this.appendEl("textGroup",this.drawText());let u={x:i.startPointAtDeg>270||i.startPointAtDeg<=90?0:100,y:i.startPointAtDeg<180?0:100};d.setAttribute("style",`transform-origin: ${u.x}% ${u.y}%; 
                                    transform-box: fill-box;
                                    `)}drawItems(){let e=l("g",{class:"rolloc__item-group"}),t=this.options.items,r=this.options.items.length,n=this.getRadius();for(let o=0;o<r;o++){let i=1/r*360,s={start:o*i,end:(o+1)*i};t[o].startAngle=s.start,t[o].endAngle=s.end;let a=[this.getArcCoordinate(s.start,n),this.getArcCoordinate(s.end,n)],d=this.getPiePath(a[0],a[1]),u=l("path",{d,stroke:"black",fill:"transparent"});e.appendChild(u)}return e}drawText(){let e=l("g",{class:"rolloc__texts"}),t=this.options.items;for(let r=0;r<t.length;r++){let n=l("g",{class:"rolloc__text"}),o=1/t.length*360,i={start:r*o,end:(r+1)*o},s=this.getArcCoordinate(i.start+(i.end-i.start)/2,this.getRadius()*2/3),a=l("text",{x:s.x,y:s.y,"text-anchor":"middle","transform-box":"fill-box","transform-origin":"center","dominant-baseline":"middle"},t[r].text);n.appendChild(a),e.appendChild(n)}return e}appendEl(e,t){this.el.appendChild(t),this.elements[e]=t}getPiePath(e,t){let{x:r,y:n}=this.getCenterPoint(),o=1/this.options.items.length*360<=180?0:1,i=this.getRadius();return`
            M${r},${n}
            L${e.x},${e.y}
            A${i},${i} 0 ${o} 1 ${t.x} ${t.y}
            L${r},${n}
            Z
        `}getCenterPoint(){return{x:this.options.size/2,y:this.options.size/2}}getArcCoordinate(e,t){t||(t=this.getRadius());let r=this.getCenterPoint(),n=e*Math.PI/180,o=t*Math.cos(n),i=t*Math.sin(n);return{x:o+r.x,y:i+r.y}}roll(e){e=h(h({},this.options.rollOptions),e);let t=this.elements.line,r=typeof e.duration=="object"?Math.floor(Math.random()*(e.duration.max-e.duration.min+1)+e.duration.min):~~e.duration,n=r*(Math.random()*2+1);return this.degreeRotated+=n,t.animate([{rotate:this.degreeRotated+"deg"}],{duration:r,fill:"forwards",easing:"cubic-bezier(0.16, 1, 0.3, 1)"}),new Promise(o=>setTimeout(()=>o(this.getResult()),r))}getResult(){let e=(this.degreeRotated+this.options.arrow.startPointAtDeg)%360;for(let t=0;t<this.options.items.length;t++){let r=this.options.items[t];if(e>r.startAngle&&e<=r.endAngle)return r}return null}},g=y;C(g,"ns","http://www.w3.org/2000/svg");function l(e,t,r=""){let n=document.createElementNS(g.ns,e);return Object.keys(t).forEach(o=>n.setAttribute(o,t[o].toString())),n.innerHTML=r,n}function $(e,t){return new g(e,t)}const E=$("#roller",{items:[{value:"grape",text:"Grape"},{value:"apple",text:"Apple"},{value:"orange",text:"Orange"},{value:"lemon",text:"Lemon"}],arrow:{startPointAtDeg:220,gapFromCenter:10,lineLength:70}});let O=document.querySelector("button");O.addEventListener("click",e=>{e.preventDefault();let t=document.querySelector("input");E.roll({duration:~~t.value}).then(r=>{alert("success roll, result = "+r.value)})});const R=document.querySelector("#canvas"),m=R.getContext("2d");m.beginPath();m.arc(50,50,25,0,Math.PI*.3);m.stroke();
