var x=Object.defineProperty;var w=(e,t,r)=>t in e?x(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var c=(e,t,r)=>(w(e,typeof t!="symbol"?t+"":t,r),r);const P=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}};P();var v=Object.defineProperty,f=Object.getOwnPropertySymbols,_=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable,g=(e,t,r)=>t in e?v(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,h=(e,t)=>{for(var r in t||(t={}))_.call(t,r)&&g(e,r,t[r]);if(f)for(var r of f(t))b.call(t,r)&&g(e,r,t[r]);return e},A=(e,t,r)=>(g(e,typeof t!="symbol"?t+"":t,r),r),C={size:500,padding:0,arrow:{startPointAtDeg:100,gapFromCenter:10,lineLength:70},rollOptions:{duration:5e3},items:[]},y=class{constructor(e,t){c(this,"el");c(this,"elements",{});c(this,"options");c(this,"degreeRotated",0);this.options=h(h({},C),t),this.mount(e)}resolveSelector(e){return typeof e=="string"?document.querySelector(e):e||null}getRadius(){return this.options.size/2-this.options.padding*2}mount(e){if(this.el)throw new Error("[rolloc] already mounted, unmount previous target first");let t=this.resolveSelector(e);if(!t)throw new Error("[rolloc] target element not found");this.el=document.createElementNS(y.ns,"svg"),this.el.setAttributeNS(null,"viewBox",`0 0 ${this.options.size} ${this.options.size}`),this.el.setAttributeNS(null,"width",this.options.size.toString()),this.el.setAttributeNS(null,"height",this.options.size.toString()),this.draw(),t.appendChild(this.el)}draw(){let e=this.getRadius(),{x:t,y:r}=this.getCenterPoint(),n=s("circle",{class:"rolloc__outer-circle",cx:t.toString(),cy:r.toString(),r:e.toString(),fill:"white"}),i=s("circle",{class:"rolloc__inner-circle",cx:t,cy:r,r:20,fill:"#ccc",stroke:"#333"}),o=this.options.arrow,l=this.getCenterPoint(),a=this.getArcCoordinate(o.startPointAtDeg,o.lineLength),d=s("line",{class:"rolloc__arrow",x1:l.x,x2:a.x,y1:l.y,y2:a.y,stroke:"black"});this.appendEl("outerCircle",n),this.appendEl("line",d),this.appendEl("itemsGroup",this.drawItems()),this.appendEl("innerCircle",i),this.appendEl("textGroup",this.drawText());let u={x:o.startPointAtDeg>270||o.startPointAtDeg<=90?0:100,y:o.startPointAtDeg<180?0:100};d.setAttribute("style",`transform-origin: ${u.x}% ${u.y}%; 
                                    transform-box: fill-box;
                                    `)}drawItems(){let e=s("g",{class:"rolloc__item-group"}),t=this.options.items,r=this.options.items.length,n=this.getRadius();for(let i=0;i<r;i++){let o=1/r*360,l={start:i*o,end:(i+1)*o};t[i].startAngle=l.start,t[i].endAngle=l.end;let a=[this.getArcCoordinate(l.start,n),this.getArcCoordinate(l.end,n)],d=this.getPiePath(a[0],a[1]),u=s("path",{d,stroke:"black",fill:"transparent"});e.appendChild(u)}return e}drawText(){let e=s("g",{class:"rolloc__texts"}),t=this.options.items;for(let r=0;r<t.length;r++){let n=s("g",{class:"rolloc__text"}),i=1/t.length*360,o={start:r*i,end:(r+1)*i},l=this.getArcCoordinate(o.start+(o.end-o.start)/2,this.getRadius()*2/3),a=s("text",{x:l.x,y:l.y,"text-anchor":"middle","transform-box":"fill-box","transform-origin":"center","dominant-baseline":"middle"},t[r].text);n.appendChild(a),e.appendChild(n)}return e}appendEl(e,t){this.el.appendChild(t),this.elements[e]=t}getPiePath(e,t){let{x:r,y:n}=this.getCenterPoint(),o=1/this.options.items.length*360<=180?0:1,l=this.getRadius();return`
            M${r},${n}
            L${e.x},${e.y}
            A${l},${l} 0 ${o} 1 ${t.x} ${t.y}
            L${r},${n}
            Z
        `}getCenterPoint(){return{x:this.options.size/2,y:this.options.size/2}}getArcCoordinate(e,t){t||(t=this.getRadius());let r=this.getCenterPoint(),n=e*Math.PI/180,i=t*Math.cos(n),o=t*Math.sin(n);return{x:i+r.x,y:o+r.y}}roll(e){e=h(h({},this.options.rollOptions),e);let t=this.elements.line,r=typeof e.duration=="object"?Math.floor(Math.random()*(e.duration.max-e.duration.min+1)+e.duration.min):~~e.duration,n=r*(Math.random()*2+1);return this.degreeRotated+=n,t.animate([{rotate:this.degreeRotated+"deg"}],{duration:r,fill:"forwards",easing:"cubic-bezier(0.16, 1, 0.3, 1)"}),new Promise(i=>setTimeout(()=>i(this.getResult()),r))}getResult(){let e=(this.degreeRotated+this.options.arrow.startPointAtDeg)%360;for(let t=0;t<this.options.items.length;t++){let r=this.options.items[t];if(e>r.startAngle&&e<=r.endAngle)return r}return null}},p=y;A(p,"ns","http://www.w3.org/2000/svg");function s(e,t,r=""){let n=document.createElementNS(p.ns,e);return Object.keys(t).forEach(i=>n.setAttribute(i,t[i].toString())),n.innerHTML=r,n}function S(e,t){return new p(e,t)}const E=S("#roller",{items:[{value:"grape",text:"Grape"},{value:"apple",text:"Apple"},{value:"orange",text:"Orange"},{value:"lemon",text:"Lemon"}],arrow:{startPointAtDeg:220,gapFromCenter:10,lineLength:70}});let O=document.querySelector("button");O.addEventListener("click",e=>{e.preventDefault();let t=document.querySelector("input");E.roll({duration:~~t.value}).then(r=>{alert("success roll, result = "+r.value)})});const R=document.querySelector("#canvas"),m=R.getContext("2d");m.beginPath();m.arc(50,50,25,0,Math.PI*.3);m.stroke();
